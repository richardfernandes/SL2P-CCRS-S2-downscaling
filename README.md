# SL2P-CCRS-S2-downscaling
Workflow to produce 10m Sentinel-2 Products using SL2P-CCRS + Downscaling

This is a workflow that allows production of 10m resolution maps of vegetation biophysical parameters from Sentinel 2 satellite imagery.
The maps are generated by applying the SL2P-CCRS algorithm (https://github.com/richardfernandes/SL2P-SL2PCCRS-Python) to Sentinel 2 Imagery with 20m bands downscaled to 10m using ATPRK (https://github.com/qunmingwang/Code-for-S2-fusion).

You will need Matlab to run ATPRK. 

1. extract https://github.com/qunmingwang/Code-for-S2-fusion and update it with the .m files in SL2P-CCRS-S2-downscaling (some are sligtly modified)
2. download S2 SAFE images from the Copernicus Data Hub , update applyATPRKtoSAFE with the directory holding these and an output directory and run
3. the output directory will contain SAFE products exactly like the input but with new 10m bands required by SL2P
4. update the directory containing SL2P-SL2PCCRS-Python by adding SL2P-CCRS-S2-downscaling.ipynb 
5. in a python environment , configure and apply SL2P-CCRS-S2-downscaling.ipynb to the input data

The output will be three different multiband geotiff images corresponding to the desired SL2P-CCRS output product for each of three land cover groups:
evergreen needleaf forst, deciduous broadleaf forest and shrubs, other.  You will need to post process these three products with 10m land cover OR if you dont have it just use the "other" class and apply bias correction from Fernandes et al. 2023. You may need to improve the cler sky masking as SAFE products have lots of comission errors.




References:

Bias correction if needed
Fernandes, R., Brown, L., §Canisius, F., Dash, J., He, L., §Hong, G., Huang, L., Le, N. Q., §MacDougall, C., Meier, C., Darko, P. O., Shah, H., Spafford, L., & §Sun, L. (2023). Validation of Simplified Level 2 Prototype Processor Sentinel-2 fraction of canopy cover, fraction of absorbed photosynthetically active radiation, and leaf area index products over North American forests. Remote Sensing of Environment, 293, 113600. 

SL2P-CCRS
Fernandes, R., §Djamai, N., §Harvey, K., §Hong, G., §MacDougall, C., §Shah, H., & §Sun, L. (2024). Evidence of a bias-variance trade-off when correcting for bias in Sentinel-2 forest LAI retrievals using radiative transfer models. Remote Sensing of Environment, 305, 114060.  
Fernandes, R., Hong, G., Brown, L. A., Dash, J., Harvey, K., Kalimipalli, S., MacDougall, C., Meier, C., Morris, H., Shah, H., Sharma, A., & Sun, L. (2024). Not just a pretty picture: Mapping leaf area index at 10 m resolution using Sentinel-2. Remote Sensing of Environment, 311, 114269. https://doi.org/10.1016/j.rse.2024.114269

AATPRK+SL2P paper (but use SL2P-CCRS if you have land cover and need lower bias at the cost of precision)
Fernandes, R., §Hong, G., Brown, L. A., Dash, J., §Harvey, K., §Kalimipalli, S., §MacDougall, C., Meier, C., Morris, H., §Shah, H., §Sharma, A., & §Sun, L. (2024). Not just a pretty picture: Mapping leaf area index at 10 m resolution using Sentinel-2. Remote Sensing of Environment, 311, 114269. https://doi.org/10.1016/j.rse.2024.114269
